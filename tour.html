<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ツアーセットリスト比較ページ</title>
  <style>
    th,
    td {
      border: 1px solid #ccc;
      text-align: center;
    }
    
        .cyan {
            background-color: cyan;
        }

        .orange {
            background-color: orange;
        }

        .pink {
            background-color: pink;
        }
  </style>
</head>

<body>
  <h1>ツアーセットリスト比較ページ</h1>
  <label for="tourSelect">ツアー名を選択：</label>
  <select id="tourSelect">
        <optgroup label="小倉唯">
        <option value="小倉唯 LIVE TOUR 2024 ~Bloomy × Meet you!~">小倉唯 LIVE TOUR 2024 ~Bloomy × Meet you!~</option>
        <option value="小倉唯 Memorial LIVE 2023 ~To the 11'Eleven~">小倉唯 Memorial LIVE 2023 ~To the 11'Eleven~</option>
        <option value="小倉唯 Memorial LIVE 2023 ~10th Anniversary Assemble!!~">小倉唯 Memorial LIVE 2023 ~10th Anniversary Assemble!!~</option>
        <option value="小倉唯 LIVE 2021「#Re♥LOVEcall」">小倉唯 LIVE 2021「#Re♥LOVEcall」</option>
        <option value="小倉唯 LIVE TOUR 2019「Step Apple」" selected>小倉唯 LIVE TOUR 2019「Step Apple」</option>
        <option value="小倉唯 2nd LIVE TOUR「Platinum Airline☆」">小倉唯 2nd LIVE TOUR「Platinum Airline☆」</option>
        <option value="小倉唯 LIVE「Smiley Cherry」">小倉唯 LIVE「Smiley Cherry」</option>
        <option value="小倉唯 1st LIVE TOUR「High-Touch☆Summer」">小倉唯 1st LIVE TOUR「High-Touch☆Summer」</option>
        <option value="小倉唯 1st LIVE「HAPPY JAM」">小倉唯 1st LIVE「HAPPY JAM」</option>
        <option value="小倉唯 Birthday Event 2025『Magical♡Party~永遠の魔法~』">小倉唯 Birthday Event 2025『Magical♡Party~永遠の魔法~』</option>
        <option value="Yui Ogura Fan Meeting 2025 in Seoul presented by KOE">Yui Ogura Fan Meeting 2025 in Seoul presented by KOE</option>
        <option value="ユイースター祭2025♡~もっと輝くわたしになぁれ!~with美的">ユイースター祭2025♡~もっと輝くわたしになぁれ!~with美的</option>
        <option value="小倉唯 Yuiʼs*Company.社員総会2025~あけおめ Rock you ☆ The time has come~">小倉唯 Yuiʼs*Company.社員総会2025~あけおめ Rock you ☆ The time has come~</option>
        <option value="小倉唯 Birthday Event 2024“唯涼祭”~Cute or Cool?~">小倉唯 Birthday Event 2024“唯涼祭”~Cute or Cool?~</option>
        <option value="Yui's＊Company.大忘年会2022~天真爛漫ゆいらんらん♪~">Yui's＊Company.大忘年会2022~天真爛漫ゆいらんらん♪~</option>
        <option value="ゆいこむ特別総会 -出張版- ~小倉唯 Birthday Party♡2022~">ゆいこむ特別総会 -出張版- ~小倉唯 Birthday Party♡2022~</option>
        <option value="Yui’s＊Company.社員総会 2021 ~Twinkle Holy Day♪~">Yui’s＊Company.社員総会 2021 ~Twinkle Holy Day♪~</option>
        <option value="小倉唯 FCイベント「Yui's＊Company.社員総会 ~New Year Party♪2020~」">小倉唯 FCイベント「Yui's＊Company.社員総会 ~New Year Party♪2020~」</option>
        <option value="小倉唯 FCイベント「ゆいゆい＊カンパニー社員総会 ~Xmasイブ×3♪~」">小倉唯 FCイベント「ゆいゆい＊カンパニー社員総会 ~Xmasイブ×3♪~」</option>
        <option value="「Step Apple」Blu-ray＆DVD発売記念イベント">「Step Apple」Blu-ray＆DVD発売記念イベント</option>
        <option value="2ndアルバム発売記念＆バースデーイベント">2ndアルバム発売記念＆バースデーイベント</option>
        <option value="小倉唯BIRTHDAY SPECIALミニライブ~SEVENTEEN!">小倉唯BIRTHDAY SPECIALミニライブ~SEVENTEEN!</option>
        </optgroup>

        <optgroup label="石原夏織">
        <option value="石原夏織 2025 LIVE「As I Am」">石原夏織 2025 LIVE「As I Am」</option>
        <option value="石原夏織 2nd LIVE TOUR -Calm Magic-">石原夏織 2nd LIVE TOUR -Calm Magic-</option>
        <option value="石原夏織 LIVE 2022「Starcast」">石原夏織 LIVE 2022「Starcast」</option>
        <option value="石原夏織 2nd LIVE「MAKE SMILE」">石原夏織 2nd LIVE「MAKE SMILE」</option>
        <option value="石原夏織 1st LIVE TOUR「Face to FACE」">石原夏織 1st LIVE TOUR「Face to FACE」</option>        
        <option value="石原夏織 1st LIVE「Sunny Spot Story」">石原夏織 1st LIVE「Sunny Spot Story」</option>    
        <option value="石原夏織 ファンクラブイベント「UNITY」vol.04">石原夏織 ファンクラブイベント「UNITY」vol.04</option>
        <option value="石原夏織 ファンクラブイベント「UNITY」vol.03">石原夏織 ファンクラブイベント「UNITY」vol.03</option>
        <option value="石原夏織 ファンクラブイベント「UNITY」vol.02">石原夏織 ファンクラブイベント「UNITY」vol.02</option>
        <option value="石原夏織 ファンクラブイベント「UNITY」vol.01">石原夏織 ファンクラブイベント「UNITY」vol.01</option>    
        <option value="石原夏織 Billboard Live 2025 横浜">石原夏織 Billboard Live 2025 横浜</option>   
        <option value="石原夏織 Billboard Live 2025 大阪">石原夏織 Billboard Live 2025 大阪</option>    
        <option value="石原夏織 SUMMER EVENT「Smile Go Happy」">石原夏織 SUMMER EVENT「Smile Go Happy」</option>
        <option value="石原夏織 AUTUMN EVENT「ONE DROP」">石原夏織 AUTUMN EVENT「ONE DROP」</option>     
        <option value="石原夏織 SUMMER EVENT「TEMPEST MISSION」">石原夏織 SUMMER EVENT「TEMPEST MISSION」</option>
        <option value="石原夏織 BIRTHDAY EVENT -Career up Carry-">石原夏織 BIRTHDAY EVENT -Career up Carry-</option>      
        <option value="石原夏織ファンクラブイベント「Ishihara Kaori Xmas Sweets Party」">石原夏織ファンクラブイベント「Ishihara Kaori Xmas Sweets Party」</option>          
        </optgroup>
    
        <optgroup label="ゆいかおり">
        <option value="ゆいかおりLIVE TOUR「Starlight Link」">ゆいかおりLIVE TOUR「Starlight Link」</option>
        <option value="ゆいかおりLIVE TOUR「RAINBOW CANARY!!」">ゆいかおりLIVE TOUR「RAINBOW CANARY!!」</option>    
        <option value="ゆいかおりLIVE TOUR「HEARTY PARTY!!」">ゆいかおりLIVE TOUR「HEARTY PARTY!!」</option>
        <option value="ゆいかおりBIRTHDAY SPECIAL LIVE「INTRODUCTION!!」">ゆいかおりBIRTHDAY SPECIAL LIVE「INTRODUCTION!!」</option>     
        <option value="ゆいかおりSPECIAL LIVE「LUCKY TUNES!!」">ゆいかおりSPECIAL LIVE「LUCKY TUNES!!」</option>
        <option value="ゆいかおりLIVE「BUNNY FLASH!!」">ゆいかおりLIVE「BUNNY FLASH!!」</option>      
        <option value="「ゆいかおりの実♪デジタル」公開録音&ミニライブ">「ゆいかおりの実♪デジタル」公開録音&ミニライブ</option>     
        <option value="ゆいかおり1st LIVE TOUR「WAKE UP!!」">ゆいかおり1st LIVE TOUR「WAKE UP!!」</option>
        <option value="ゆいかおり2nd LIVE「YELL for YOU」">ゆいかおり2nd LIVE「YELL for YOU」</option>    
        <option value="ゆいかおり1st LIVE「PUPPY LOVE!!」">ゆいかおり1st LIVE「PUPPY LOVE!!」</option>  
        </optgroup>
  </select>

  <br><br>

  <table id="concertTable">
    <!-- Concert data will be displayed here -->
  </table>

  <div class="container" id="setlistContainer"></div>

    <script>
        const concertTable = document.getElementById('concertTable');
        const tourSelect = document.getElementById('tourSelect');
        const setlistContainer = document.getElementById('setlistContainer');

        tourSelect.addEventListener('change', () => {
            setlistContainer.innerHTML = '';
            concertTable.innerHTML = '';
            const selectedTour = tourSelect.value;

            if (selectedTour) {
                fetch('setlist.json')
                    .then(response => response.json())
                    .then(data => {
                        const concerts = data.filter(item => item.tourtitle === selectedTour);
                        concerts.sort((a, b) => a.id.localeCompare(b.id));
                      
            const maxSetlistLength = Math.max(...concerts.map(concert => concert.setlist.length));
            const maxEncoreLength = Math.max(...concerts.map(concert => Array.isArray(concert.encore) ? concert.encore.length : (concert.encore ? 1 : 0)));

            concerts.forEach(concert => {
              while (concert.setlist.length < maxSetlistLength) {
                concert.setlist.push('');
              }

              // concert.encore が null や undefined の場合は空の配列にする
              if (!Array.isArray(concert.encore)) {
                  concert.encore = concert.encore ? [concert.encore] : [];
              }
              
              if (concert.encore) {
                while (concert.encore.length < maxEncoreLength) {
                  concert.encore.push('');
                }
              }
            });

            const table = document.createElement('table');

            const headerRow = table.insertRow();
            headerRow.insertCell().textContent = '';
            concerts.forEach(concert => {
              headerRow.insertCell().textContent = concert.LIVEtitle.replace(concert.tourtitle, '');
            });
                        
                        const dateRow = table.insertRow();
                        dateRow.insertCell().textContent = '開催日';
                        concerts.forEach(concert => {
                            dateRow.insertCell().textContent = concert.date;
                        });

                        const venueRow = table.insertRow();
                        venueRow.insertCell().textContent = '会場';
                        concerts.forEach(concert => {
                            venueRow.insertCell().textContent = concert.venue;
                        });

                        const row = table.insertRow();
                        row.insertCell().textContent = '';
                        concerts.forEach(concert => {
                            row.insertCell().textContent = '【セットリスト】';
                        });

            const setlistRows = maxSetlistLength;

            for (let i = 0; i < setlistRows; i++) {
              const row = table.insertRow();
              const indexCell = row.insertCell();
              indexCell.textContent = i + 1;

const setlistValues = concerts.map(concert => {
  const song = concert.setlist[i];
  if (typeof song === 'object' && song.medley) {
    // メドレーの各曲にリンクを追加し、改行して表示
    const medleyLinks = song.medley.map(track => 
      `<a href="./sub/search.html?name=${encodeURIComponent(track)}">${track}</a>`
    ).join('<br>');
    return `【メドレー】<br>${medleyLinks}`;
  } else {
    return song ? `<a href="./sub/search.html?name=${encodeURIComponent(song)}">${song}</a>` : ''; 
  }
});


              const isSame = setlistValues.every((val, idx, arr) => val === arr[0]);

              setlistValues.forEach((value, idx) => {
                const cell = row.insertCell();
                cell.innerHTML = value;
                cell.style.whiteSpace = 'pre-wrap'; // 改行を反映させる
                if (!isSame) {
                  if (selectedTour.includes('石原夏織')) {
                    row.classList.add('cyan');
                  } else if (selectedTour.includes('ゆいかおり')) {
                    row.classList.add('orange');
                　} else {
                  　row.classList.add('pink');
                  }
                }
              });
            }

const encoreList = concerts.map(concert => {
  if (Array.isArray(concert.encore)) {
    return concert.encore;
  } else {
    return [concert.encore];
  }
});

if (encoreList[0][0]) {
  const encorerow = table.insertRow();
  encorerow.insertCell().textContent = '';
  concerts.forEach(concert => {
    encorerow.insertCell().textContent = '【アンコール】';
  });

  const maxEncoreRows = Math.max(...encoreList.map(encore => encore.length));

  for (let i = 0; i < maxEncoreRows; i++) {
    const row = table.insertRow();
    const indexCell = row.insertCell();
    indexCell.textContent = 'EC' + (i + 1);

    const encoreValues = encoreList.map(encore => {
      const song = encore[i];
  if (typeof song === 'object' && song.medley) {
    // メドレーの各曲にリンクを追加し、改行して表示
    const medleyLinks = song.medley.map(track => 
      `<a href="./sub/search.html?name=${encodeURIComponent(track)}">${track}</a>`
    ).join('<br>');
    return `【メドレー】<br>${medleyLinks}`;
  } else {
    return song ? `<a href="./sub/search.html?name=${encodeURIComponent(song)}">${song}</a>` : ''; 
  }
});

    const isSameEncore = encoreValues.every((val, idx, arr) => val === arr[0]);

    encoreValues.forEach((value, idx) => {
      const cell = row.insertCell();
      cell.innerHTML = value;
      cell.style.whiteSpace = 'pre-wrap'; // 改行を反映させる
      if (!isSameEncore) {
        if (selectedTour.includes('石原夏織')) {
          row.classList.add('cyan');
        } else if (selectedTour.includes('ゆいかおり')) {
          row.classList.add('orange');
        } else {
          row.classList.add('pink');
        }
      }
    });
  }
}
if (concerts.some(concert => concert.Wencore)) {
  const wencorerow = table.insertRow();
  const cell = wencorerow.insertCell();
  cell.textContent = 'WEC';

  concerts.forEach(concert => {
    const cell = wencorerow.insertCell();
    if (concert.Wencore) {
      cell.innerHTML = `<a href="./sub/search.html?name=${encodeURIComponent(concert.Wencore)}">${concert.Wencore}</a>`;
    } else {
      cell.innerHTML = '&nbsp;'; // 空白のセルを維持
    }
  });
}

            setlistContainer.appendChild(table);
          });
      }
    });
  </script>
</body>

</html>
